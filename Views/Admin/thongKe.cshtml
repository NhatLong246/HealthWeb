<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thống kê tổng quan - WebHealthy Admin</title>
    <!-- CSS Files -->
    <link rel="stylesheet" href="~/asset/css/admin.css" asp-append-version="true">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="~/css/common/toast.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/common/dialog.css" asp-append-version="true" />

    <!-- JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

    <!-- JavaScript Files -->
    <script src="~/asset/js/thongKe.js" asp-append-version="true"></script>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar will be loaded by sidebar.js -->
        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1 id="page-title">Thống kê tổng quan</h1>
                <div class="header-actions">
                    <div class="date-range-picker" id="filter-date-range-picker">
                        <button type="button" class="date-range-btn" id="filter-date-range-btn">
                            <i class="fas fa-calendar-alt"></i>
                            <span id="filter-date-range-text">Chọn khoảng thời gian</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="date-range-dropdown" id="filter-date-range-dropdown">
                            <!-- Date picker content will be generated by JavaScript -->
                        </div>
                    </div>
                    <div class="user-menu">
                        <i class="fas fa-user-circle"></i>
                    </div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <!-- Analytics Tabs -->
                <div class="analytics-tabs-container">
                    <div class="analytics-tabs-grid">
                        <button class="analytics-tab-card active tab-users" data-tab="user-analytics">
                            <div class="tab-icon-wrapper">
                                <i class="fas fa-users-cog"></i>
                            </div>
                            <div class="tab-content">
                                <h3>Thống kê người dùng</h3>
                                <p>User Analytics</p>
                            </div>
                            <div class="tab-indicator"></div>
                        </button>

                        <button class="analytics-tab-card tab-pt" data-tab="pt-analytics">
                            <div class="tab-icon-wrapper">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div class="tab-content">
                                <h3>Thống kê PT</h3>
                                <p>PT Performance</p>
                            </div>
                            <div class="tab-indicator"></div>
                        </button>

                        <button class="analytics-tab-card tab-health" data-tab="health-analytics">
                            <div class="tab-icon-wrapper">
                                <i class="fas fa-heart-pulse"></i>
                            </div>
                            <div class="tab-content">
                                <h3>Thống kê sức khỏe</h3>
                                <p>Health Trends</p>
                            </div>
                            <div class="tab-indicator"></div>
                        </button>

                        <button class="analytics-tab-card tab-goals" data-tab="goals-analytics">
                            <div class="tab-icon-wrapper">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="tab-content">
                                <h3>Thống kê mục tiêu</h3>
                                <p>Goals Analytics</p>
                            </div>
                            <div class="tab-indicator"></div>
                        </button>


                        <button class="analytics-tab-card tab-nutrition" data-tab="nutrition-analytics">
                            <div class="tab-icon-wrapper">
                                <i class="fas fa-utensils"></i>
                            </div>
                            <div class="tab-content">
                                <h3>Thống kê dinh dưỡng</h3>
                                <p>Nutrition Insights</p>
                            </div>
                            <div class="tab-indicator"></div>
                        </button>

                        <button class="analytics-tab-card tab-finance" data-tab="finance-analytics">
                            <div class="tab-icon-wrapper">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="tab-content">
                                <h3>Thống kê tài chính</h3>
                                <p>Finance Analytics</p>
                            </div>
                            <div class="tab-indicator"></div>
                        </button>

                    </div>
                </div>

                <!-- Quick Stats Overview -->
                <div class="stats-overview">
                    <div class="stat-card">
                        <div class="stat-icon users-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Tổng người dùng</h3>
                            <p class="stat-number" data-target="0">-</p>
                            <span class="stat-change">
                                <i class="fas fa-arrow-up"></i> -
                            </span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon trainers-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Tổng huấn luyện viên</h3>
                            <p class="stat-number" data-target="0">-</p>
                            <span class="stat-change">
                                <i class="fas fa-arrow-up"></i> -
                            </span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon revenue-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Doanh thu tháng</h3>
                            <p class="stat-number" data-target="0">-</p>
                            <span class="stat-currency">VNĐ</span>
                            <span class="stat-change">
                                <i class="fas fa-arrow-up"></i> -
                            </span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon health-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="stat-content">
                            <h3>Hoạt động hôm nay</h3>
                            <p class="stat-number" data-target="0">-</p>
                            <span class="stat-change">
                                <i class="fas fa-arrow-up"></i> -
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Analytics Panels -->
                <!-- 1. User Analytics -->
                <div class="analytics-panel active" id="panel-user-analytics">
                    <div class="analytics-header">
                        <h2><i class="fas fa-users"></i> Thống kê người dùng (User Analytics)</h2>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Tổng số người dùng</h3>
                            <div class="metric-value">-</div>
                        </div>

                        <div class="analytics-card">
                            <h3>Hoạt động người dùng</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">DAU (Hôm nay)</span>
                                    <span class="metric-value-small">- <span class="percentage">-</span></span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">MAU (Tháng này)</span>
                                    <span class="metric-value-small">- <span class="percentage">-</span></span>
                                </div>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Tỷ lệ quay lại (Retention Rate)</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">7 ngày</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">30 ngày</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="chart-section">
                        <div class="chart-card">
                            <h4>Phân bố người dùng theo giới tính</h4>
                            <div class="chart-wrapper">
                            <canvas id="userGenderChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h4>Thống kê số tuổi luyện tập</h4>
                            <div class="chart-wrapper">
                            <canvas id="userAgeChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="top-users-section">
                        <h3>Top 10 người dùng có hoạt động cao nhất</h3>
                        <div class="top-list" id="top-users-list">
                            <!-- Top users will be loaded dynamically from database -->
                            </div>
                    </div>
                </div>

                <!-- 2. PT Performance Analytics -->
                <div class="analytics-panel" id="panel-pt-analytics">
                    <div class="analytics-header">
                        <h2><i class="fas fa-user-tie"></i> Thống kê huấn luyện viên (PT Performance)</h2>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Tổng số PT</h3>
                            <div class="metric-value">-</div>
                        </div>

                        <div class="analytics-card">
                            <h3>Trạng thái PT</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">Đang hoạt động</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Nghỉ</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Dừng nhận khách</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Hiệu suất PT</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">TB khách hàng/PT</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">TB doanh thu/PT/tháng</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Đánh giá TB</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Tỷ lệ hủy lịch</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-details">
                                <span>Tổng lịch tập: <strong>-</strong></span>
                                <span>Bị hủy/từ chối: <strong>-</strong></span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-section">
                        <div class="chart-card full-width">
                            <h4>Doanh thu theo PT</h4>
                            <canvas id="ptRevenueChart"></canvas>
                        </div>
                    </div>

                    <div class="top-users-section">
                        <h3>Top 5 PT có doanh thu cao nhất</h3>
                        <div class="top-list" id="top-pt-list">
                            <!-- Top PTs will be loaded dynamically from database -->
                        </div>
                    </div>
                </div>

                <!-- 3. Health Trends -->
                <div class="analytics-panel" id="panel-health-analytics">
                    <div class="analytics-header">
                        <h2><i class="fas fa-heartbeat"></i> Thống kê sức khỏe người dùng</h2>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Chỉ số trung bình</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">BMI</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Chiều cao (cm)</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Cân nặng (kg)</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Nước (lít)</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Phân bố BMI</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">Bình thường</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Thừa cân</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Béo phì</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Thiếu cân</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Tỷ lệ người dùng có bệnh nền</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-details">
                                <span>Số người dùng có bệnh nền: <strong>-</strong></span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-section">
                        <div class="chart-card">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <h4 style="margin: 0;">Xu hướng BMI</h4>
                                <div class="chart-legend-inline" id="bmiTrendLegend">
                                    <span style="display: inline-flex; align-items: center; gap: 6px;">
                                        <span style="display: inline-block; width: 12px; height: 12px; background-color: #ef4444; border-radius: 2px;"></span>
                                        <span style="font-size: 12px; color: #666;">BMI trung bình</span>
                                    </span>
                                </div>
                            </div>
                            <canvas id="bmiTrendChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <h4 style="margin: 0;">Xu hướng người mắc bệnh nền</h4>
                                <div class="chart-legend-inline" id="diseaseTrendLegend">
                                    <span style="display: inline-flex; align-items: center; gap: 6px;">
                                        <span style="display: inline-block; width: 12px; height: 12px; background-color: #8b5cf6; border-radius: 2px;"></span>
                                        <span style="font-size: 12px; color: #666;">Số người mắc bệnh nền</span>
                                    </span>
                                </div>
                            </div>
                            <canvas id="diseaseTrendChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4>Trình độ người dùng</h4>
                            <canvas id="userLevelChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- 4. Goals Analytics -->
                <div class="analytics-panel" id="panel-goals-analytics">
                    <div class="analytics-header">
                        <h2><i class="fas fa-bullseye"></i> Thống kê mục tiêu</h2>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Tổng mục tiêu</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-details">
                                <span>Đã hoàn thành: <strong>-</strong></span>
                                <span>Đang thực hiện: <strong>-</strong></span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Phân bố mục tiêu theo trạng thái</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">Hoàn thành</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Đang thực hiện</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Thời gian hoàn thành TB</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-details">
                                <span>Từ ngày bắt đầu → hoàn thành</span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-section">
                        <div class="chart-card">
                            <h4>Phân bố loại mục tiêu</h4>
                            <canvas id="goalsTypeChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4>Phân bố loại kế hoạch</h4>
                            <canvas id="workoutTypeChart"></canvas>
                        </div>
                    </div>

                    <div class="top-users-section">
                        <h3>Top 10 loại mục tiêu phổ biến nhất</h3>
                        <div class="top-list" id="top-goals-list">
                            <!-- Top goals will be loaded dynamically from database -->
                            </div>
                    </div>
                </div>


                <!-- 6. Nutrition Analytics -->
                <div class="analytics-panel" id="panel-nutrition-analytics">
                    <div class="analytics-header">
                        <h2><i class="fas fa-apple-alt"></i> Thống kê ăn uống & dinh dưỡng</h2>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Kế hoạch ăn đang hoạt động</h3>
                            <div class="metric-value">-</div>
                        </div>

                        <div class="analytics-card">
                            <h3>Calo trung bình / món ăn</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-details">
                                <span>kcal</span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>Phân bố macro TB</h3>
                            <div class="metric-row">
                                <div class="metric-item">
                                    <span class="metric-label">Protein</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Carbs</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Fat</span>
                                    <span class="metric-value-small">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="chart-section">
                        <div class="chart-card">
                            <h4>Xu hướng các món ăn được ưa chuộng</h4>
                            <canvas id="nutritionCalorieTrendChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4>Phân bố macro nutrients</h4>
                            <canvas id="nutritionMacroChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- 7. Finance Analytics -->
                <div class="analytics-panel" id="panel-finance-analytics">
                    <div class="analytics-header">
                        <h2><i class="fas fa-money-bill-wave"></i> Thống kê giao dịch & doanh thu</h2>
                    </div>

                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3>Tổng giao dịch</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-details">
                                <span>Thành công: <strong>-</strong></span>
                                <span>Thất bại: <strong>-</strong></span>
                            </div>
                        </div>

                        <div class="analytics-card">
                            <h3>TB doanh thu/PT</h3>
                            <div class="metric-value">-</div>
                            <div class="metric-currency">VNĐ</div>
                        </div>
                    </div>

                    <div class="chart-section">
                        <div class="chart-card">
                            <h4>Doanh thu theo phương thức thanh toán</h4>
                            <canvas id="paymentMethodChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4>Xu hướng lợi nhuận</h4>
                            <canvas id="revenueTrendChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="recent-activity">
                    <h2>Hoạt động gần đây</h2>
                    <div class="activity-list" id="recent-activities-list">
                        <!-- Activities will be loaded dynamically from database -->
                    </div>
                </div>
            </section>
        </main>
    </div>
    <script src="~/js/common/toast.js" asp-append-version="true"></script>
    <script src="~/js/common/dialog.js" asp-append-version="true"></script>
    <script src="~/asset/js/sidebar.js" asp-append-version="true"></script>
</body>
</html>

