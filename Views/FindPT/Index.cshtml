@{
    ViewData["Title"] = "Tìm Kiếm Huấn Luyện Viên - HealthWeb";
    Layout = "_Layout";
}
@Html.AntiForgeryToken()

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="~/css/findpt/findpt.css">

<div class="find-pt-container">
    <div class="find-pt-header">
        <h1><i class="fas fa-dumbbell"></i> Tìm Kiếm Huấn Luyện Viên</h1>
        <p>Khám phá và kết nối với những huấn luyện viên chuyên nghiệp phù hợp với bạn</p>
    </div>

    <!-- Search and Filters Section -->
    <div class="search-filters-section">
        <div class="search-bar">
            <div class="search-input-wrapper">
                <i class="fas fa-search"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="Tìm kiếm theo tên, chuyên môn, kỹ năng...">
            </div>
            <button class="search-btn" onclick="searchPTs()">
                <i class="fas fa-search"></i> Tìm kiếm
            </button>
        </div>

        <div class="filters">
            <div class="filter-group">
                <label><i class="fas fa-map-marker-alt"></i> Thành phố</label>
                <select id="locationFilter">
                    <option value="">Tất cả</option>
                    <option value="Hà Nội">Hà Nội</option>
                    <option value="TP.HCM">TP.HCM</option>
                    <option value="Đà Nẵng">Đà Nẵng</option>
                    <option value="Hải Phòng">Hải Phòng</option>
                    <option value="Online">Online</option>
                </select>
            </div>

            <div class="filter-group">
                <label><i class="fas fa-dumbbell"></i> Chuyên môn</label>
                <select id="specializationFilter">
                    <option value="">Tất cả</option>
                    <option value="Weight Loss">Giảm cân</option>
                    <option value="Muscle Gain">Tăng cơ</option>
                    <option value="Yoga">Yoga</option>
                    <option value="Cardio">Cardio</option>
                    <option value="Pilates">Pilates</option>
                    <option value="Rehabilitation">Phục hồi</option>
                </select>
            </div>

            <button class="clear-filters-btn" onclick="clearFilters()">
                <i class="fas fa-times"></i> Xóa bộ lọc
            </button>
        </div>
    </div>

    <!-- Results Section -->
    <div class="results-section">
        <div class="results-header">
            <h2 id="resultsCount">Đang tải...</h2>
        </div>
        
        <!-- Active Filters Display -->
        <div id="activeFiltersDisplay" class="active-filters" style="display: none;">
            <div class="active-filters-label">
                <i class="fas fa-filter"></i> Đang lọc:
            </div>
            <div id="activeFiltersList" class="active-filters-list">
                <!-- Active filter tags will be added here -->
            </div>
            <button class="btn-clear-all-filters" onclick="clearFilters()" title="Xóa tất cả bộ lọc">
                <i class="fas fa-times"></i> Xóa tất cả
            </button>
        </div>

        <div class="pt-cards-grid" id="ptCardsGrid">
            <!-- PT cards will be loaded here -->
        </div>

        <div class="empty-state" id="emptyState" style="display: none;">
            <i class="fas fa-search"></i>
            <p>Không tìm thấy huấn luyện viên nào phù hợp</p>
            <button onclick="clearFilters()" class="btn-primary">Xóa bộ lọc</button>
        </div>

        <div class="loading-state" id="loadingState">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Đang tải...</p>
        </div>
    </div>
</div>

<!-- PT Detail Modal -->
<div class="modal" id="ptDetailModal">
    <div class="modal-content">
        <span class="close" onclick="closePTDetailModal()">&times;</span>
        <div id="ptDetailContent">
            <!-- PT details will be loaded here -->
        </div>
    </div>
</div>

<!-- Request Training Modal -->
<div class="modal" id="requestModal">
    <div class="modal-content request-modal-content">
        <div class="request-modal-header">
            <div class="request-modal-title">
                <div class="request-modal-icon">
                    <i class="fas fa-calendar"></i>
                    <i class="fas fa-check request-check-icon"></i>
                </div>
                <h2>Gửi Yêu Cầu Tập Luyện</h2>
            </div>
            <span class="close" onclick="closeRequestModal()">&times;</span>
        </div>
        <div class="request-modal-body">
            <form id="requestForm" onsubmit="submitRequest(event)">
            <input type="hidden" id="requestPtId">
            
            <!-- Mục tiêu luyện tập -->
            <div class="form-group">
                <label><i class="fas fa-bullseye"></i> Mục tiêu luyện tập</label>
                <div class="select-wrapper">
                    <select id="requestGoal" required>
                        <option value="">Chọn mục tiêu</option>
                        @{
                            var danhSachMucTieu = ViewBag.DanhSachMucTieu as List<string> ?? new List<string>();
                        }
                        @foreach (var mucTieu in danhSachMucTieu)
                        {
                            <option value="@mucTieu">@mucTieu</option>
                        }
                    </select>
                    <i class="fas fa-chevron-down select-arrow"></i>
                </div>
            </div>

            <!-- Chọn ngày và thời gian -->
            <div class="form-group">
                <label><i class="fas fa-calendar-week"></i> Chọn ngày và thời gian</label>
                <div id="dateScheduleContainer">
                    <!-- Date schedule items will be added here -->
                </div>
                <button type="button" class="btn-add-date" onclick="addDateSchedule()" style="margin-top: 1rem;">
                    <i class="fas fa-plus"></i> Thêm ngày
                </button>
                <small class="form-hint">Chọn ít nhất một ngày (sau ngày hiện tại) và nhập thời gian rảnh</small>
            </div>

            <div class="form-group">
                <label><i class="fas fa-sticky-note"></i> Ghi chú bổ sung (tùy chọn)</label>
                <textarea id="requestNotes" rows="2" placeholder="Ví dụ: Có chấn thương đầu gối, muốn tập tại phòng gym..."></textarea>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-secondary" onclick="closeRequestModal()">Hủy</button>
                <button type="submit" class="btn-primary">
                    <i class="fas fa-paper-plane"></i> Gửi yêu cầu
                </button>
            </div>
        </form>
        </div>
    </div>
</div>

<script src="~/js/findpt/findpt.js"></script>

